{{- $serviceName := include "fullname" . -}}
---
apiVersion: v1
kind: Service
metadata:
  labels:
    db: rethinkdb-node-starter
  name: rethinkdb-node-starter
spec:
  type: NodePort
  ports:
    - port: 28015
      targetPort: driver
  selector:
    db: rethinkdb-node-starter
---
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  labels:
    db: rethinkdb-node-starter
  name: rethinkdb-node-starter
spec:
  template:
    metadata:
      labels:
        db: rethinkdb-node-starter
    spec:
      securityContext:
        runAsUser: 0
      containers:
      - image: rethinkdb:2.3
        command:
        - rethinkdb
        args:
        - "--bind"
        - "all"
        name: rethinkdb-node-starter
        ports:
        - containerPort: 8080
          name: admin
        - containerPort: 28015
          name: driver